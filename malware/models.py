from __future__ import unicode_literals

from django.db import models
import os

class malwareFile(models.Model):
	id = models.AutoField(primary_key=True)
	file = models.FileField(upload_to='uploads')
	uploadDate = models.DateTimeField(auto_now=True)
	sha256 = models.CharField(max_length=64, blank=True)
	md5sum = models.CharField(max_length=32, blank=True)
	virusTotal = models.CharField(max_length=255, blank=True)
	virusTotalPerc = models.IntegerField(default=0)
	virusTotalLink = models.CharField(max_length=255, blank=True)
	wildFire = models.TextField(blank=True)
	hybridAnalysis = models.TextField(blank=True)
	notes = models.TextField(blank=True)

	class Meta:
		ordering = ['-uploadDate']
		verbose_name_plural = 'Malware'

	@property
	def filename(self):
		return os.path.basename(self.file.name)

	def __str__(self):
		return self.filename

#from malware.models import malwareFile
#malwareFile.objects.all()


